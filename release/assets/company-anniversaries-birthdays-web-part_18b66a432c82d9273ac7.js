define("34185322-991f-4636-bd81-7dbdee6c016e_0.0.1",["react","react-dom","@microsoft/sp-core-library","@microsoft/sp-property-pane","@microsoft/sp-webpart-base","@microsoft/sp-http","@microsoft/sp-lodash-subset"],(e,t,n,a,i,r,o)=>(()=>{"use strict";var s={680:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var a,i,r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};!function(e){e[e.sync=0]="sync",e[e.async=1]="async"}(a||(a={})),function(e){e[e.onlyThemable=1]="onlyThemable",e[e.onlyNonThemable=2]="onlyNonThemable",e[e.all=3]="all"}(i||(i={}));var o,s,c,d="undefined"==typeof window?n.g:window,l=d&&d.CSPSettings&&d.CSPSettings.nonce,u=((c=d.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(c=r(r({},c),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:a.sync,buffer:[]}})),c.registeredThemableStyles||(c=r(r({},c),{registeredThemableStyles:[]})),d.__themeState__=c,c),f=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,p=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function m(e){var t=p();e();var n=p();u.perf.duration+=n-t}function _(e,t){u.loadStyles?u.loadStyles(h(e).styleString,e):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),a=h(e),i=a.styleString,r=a.themable;n.setAttribute("data-load-themed-styles","true"),l&&n.setAttribute("nonce",l),n.appendChild(document.createTextNode(i)),u.perf.count++,t.appendChild(n);var o=document.createEvent("HTMLEvents");o.initEvent("styleinsert",!0,!1),o.args={newStyle:n},document.dispatchEvent(o);var s={styleElement:n,themableStyle:e};r?u.registeredThemableStyles.push(s):u.registeredStyles.push(s)}}(e)}function h(e){var t=u.theme,n=!1;return{styleString:(e||[]).map(function(e){var a=e.theme;if(a){n=!0;var i=t?t[a]:void 0,r=e.defaultValue||"inherit";return t&&!i&&console,i||r}return e.rawString}).join(""),themable:n}}o='.companyAnniversariesBirthdays_8e0aff2a{background-color:transparent;color:"[theme:bodyText, default: #323130]";color:var(--bodyText);overflow:hidden;padding:20px}.companyAnniversariesBirthdays_8e0aff2a.teams_8e0aff2a{font-family:Segoe UI,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,sans-serif}.companyAnniversariesBirthdays_8e0aff2a.centered_8e0aff2a{align-items:center;display:flex;flex-direction:column;width:100%}.companyAnniversariesBirthdays_8e0aff2a.centered_8e0aff2a .header_8e0aff2a{text-align:center;width:100%}.companyAnniversariesBirthdays_8e0aff2a.centered_8e0aff2a .listView_8e0aff2a{align-items:stretch;display:flex;flex-direction:column;max-width:800px;width:100%}.companyAnniversariesBirthdays_8e0aff2a.centered_8e0aff2a .carouselView_8e0aff2a{align-items:center;display:flex;flex-direction:column}.gridViewWithArrows_8e0aff2a{align-items:center;display:flex;gap:20px;justify-content:center;width:100%}.gridViewCentered_8e0aff2a{display:grid;gap:20px;grid-template-columns:repeat(4,1fr);max-width:1200px}@media (max-width:1200px){.gridViewCentered_8e0aff2a{grid-template-columns:repeat(3,1fr)}}@media (max-width:900px){.gridViewCentered_8e0aff2a{grid-template-columns:repeat(2,1fr)}}@media (max-width:600px){.gridViewCentered_8e0aff2a{grid-template-columns:1fr}}.arrowButton_8e0aff2a{align-items:center;background:0 0;border:none;color:#0078d4;cursor:pointer;display:flex;flex-shrink:0;font-size:64px;height:auto;justify-content:center;line-height:1;padding:0;transition:color .2s,transform .2s;width:auto}.arrowButton_8e0aff2a:hover{color:#005a9e;transform:scale(1.2)}.arrowButton_8e0aff2a:active{transform:scale(.95)}.arrowButton_8e0aff2a:focus{outline:2px solid #0078d4;outline-offset:2px}.header_8e0aff2a{border-bottom:2px solid #0078d4;margin-bottom:20px;padding-bottom:10px}.title_8e0aff2a{color:#0078d4;font-size:24px;font-weight:600;margin:0}.error_8e0aff2a,.loading_8e0aff2a,.noEvents_8e0aff2a{color:#605e5c;font-size:16px;padding:40px 20px;text-align:center}.error_8e0aff2a{background-color:#fde7e9;border-radius:4px;color:#a4262c}.gridView_8e0aff2a{display:grid;gap:20px;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));width:100%}.eventCard_8e0aff2a{border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,.1);color:#fff;padding:20px;transition:transform .2s,box-shadow .2s}.eventCard_8e0aff2a:hover{box-shadow:0 6px 12px rgba(0,0,0,.15);transform:translateY(-4px)}.iconContainer_8e0aff2a{margin-bottom:15px;text-align:center}.icon_8e0aff2a{animation:bounce_8e0aff2a 2s infinite;display:inline-block;font-size:48px}@keyframes bounce_8e0aff2a{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-10px)}60%{transform:translateY(-5px)}}.eventDetails_8e0aff2a{text-align:center}.employeeName_8e0aff2a{color:#fff;font-size:20px;font-weight:600;margin:0 0 8px}.eventType_8e0aff2a{font-size:14px;margin:4px 0;opacity:.9}.eventDate_8e0aff2a{font-size:16px;font-weight:500;margin:4px 0 0}.listView_8e0aff2a{display:flex;flex-direction:column;gap:12px}.listItem_8e0aff2a{align-items:center;background-color:#f3f2f1;border-left:4px solid #0078d4;border-radius:8px;display:flex;padding:16px;transition:background-color .2s,transform .2s}.listItem_8e0aff2a:hover{background-color:#edebe9;transform:translateX(4px)}.listIcon_8e0aff2a{flex-shrink:0;font-size:32px;margin-right:16px}.listContent_8e0aff2a{display:flex;flex:1;flex-direction:column}.listName_8e0aff2a{color:#323130;font-size:16px;font-weight:600;margin-bottom:4px}.listType_8e0aff2a{color:#605e5c;font-size:14px}.listDate_8e0aff2a{color:#0078d4;flex-shrink:0;font-size:14px;font-weight:500;margin-left:16px}.carouselView_8e0aff2a{align-items:center;display:flex;flex-direction:column;justify-content:center;min-height:300px}.carouselIndicators_8e0aff2a{display:flex;gap:8px;justify-content:center;margin-top:20px}.indicator_8e0aff2a{background-color:#c8c6c4;border-radius:50%;cursor:pointer;height:12px;transition:background-color .2s,transform .2s;width:12px}.indicator_8e0aff2a:hover{background-color:#8a8886;transform:scale(1.2)}.indicator_8e0aff2a.active_8e0aff2a{background-color:#0078d4;transform:scale(1.3)}@media (max-width:768px){.gridView_8e0aff2a{grid-template-columns:1fr}.listItem_8e0aff2a{align-items:flex-start;flex-direction:column}.listDate_8e0aff2a{margin-left:0;margin-top:8px}}',void 0===(s=!0)&&(s=!1),m(function(){var e=Array.isArray(o)?o:function(e){var t=[];if(e){for(var n=0,a=void 0;a=f.exec(e);){var i=a.index;i>n&&t.push({rawString:e.substring(n,i)}),t.push({theme:a[1],defaultValue:a[2]}),n=f.lastIndex}t.push({rawString:e.substring(n)})}return t}(o),t=u.runState,n=t.mode,i=t.buffer,r=t.flushTimer;s||n===a.async?(i.push(e),r||(u.runState.flushTimer=self.setTimeout(function(){u.runState.flushTimer=0,m(function(){var e=u.runState.buffer.slice();u.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&_(t)})},0))):_(e)});const b={companyAnniversariesBirthdays_8e0aff2a:"companyAnniversariesBirthdays_8e0aff2a",teams_8e0aff2a:"teams_8e0aff2a",centered_8e0aff2a:"centered_8e0aff2a",header_8e0aff2a:"header_8e0aff2a",listView_8e0aff2a:"listView_8e0aff2a",carouselView_8e0aff2a:"carouselView_8e0aff2a",gridViewWithArrows_8e0aff2a:"gridViewWithArrows_8e0aff2a",gridViewCentered_8e0aff2a:"gridViewCentered_8e0aff2a",arrowButton_8e0aff2a:"arrowButton_8e0aff2a",title_8e0aff2a:"title_8e0aff2a",error_8e0aff2a:"error_8e0aff2a",loading_8e0aff2a:"loading_8e0aff2a",noEvents_8e0aff2a:"noEvents_8e0aff2a",gridView_8e0aff2a:"gridView_8e0aff2a",eventCard_8e0aff2a:"eventCard_8e0aff2a",iconContainer_8e0aff2a:"iconContainer_8e0aff2a",icon_8e0aff2a:"icon_8e0aff2a",bounce_8e0aff2a:"bounce_8e0aff2a",eventDetails_8e0aff2a:"eventDetails_8e0aff2a",employeeName_8e0aff2a:"employeeName_8e0aff2a",eventType_8e0aff2a:"eventType_8e0aff2a",eventDate_8e0aff2a:"eventDate_8e0aff2a",listItem_8e0aff2a:"listItem_8e0aff2a",listIcon_8e0aff2a:"listIcon_8e0aff2a",listContent_8e0aff2a:"listContent_8e0aff2a",listName_8e0aff2a:"listName_8e0aff2a",listType_8e0aff2a:"listType_8e0aff2a",listDate_8e0aff2a:"listDate_8e0aff2a",carouselIndicators_8e0aff2a:"carouselIndicators_8e0aff2a",indicator_8e0aff2a:"indicator_8e0aff2a",active_8e0aff2a:"active_8e0aff2a"}}
,676:e=>{e.exports=n},909:e=>{e.exports=r},529:e=>{e.exports=o},877:e=>{e.exports=a},642:e=>{e.exports=i},959:t=>{t.exports=e},398:e=>{e.exports=t}},c={};function d(e){var t=c[e];if(void 0!==t)return t.exports;var n=c[e]={exports:{}};return s[e](n,n.exports,d),n.exports}d.d=(e,t)=>{for(var n in t)d.o(t,n)&&!d.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},d.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};return(()=>{d.r(l),d.d(l,{default:()=>x});var e=d(959),t=d(398),n=d(676),a=d(877),i=d(642);d(680);const r="arrowButton_8e0aff2a",o="noEvents_8e0aff2a";var s,c,u=d(909);!function(e){e.Grid="grid",e.List="list",e.Carousel="carousel"}(s||(s={})),function(e){e.All="all",e.Today="today",e.ThisWeek="thisWeek",e.ThisMonth="thisMonth",e.NextMonth="nextMonth"}(c||(c={}));var f,p=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},m=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},_=function(){function e(e,t){this.spHttpClient=e,this.siteUrl=t}return e.prototype.ensureListExists=function(){return p(this,void 0,void 0,function(){var e,t;return m(this,function(n){switch(n.label){case 0:return n.trys.push([0,7,,8]),e="Employee Celebrations",[4,this.spHttpClient.get("".concat(this.siteUrl,"/_api/web/lists/getbytitle('").concat(e,"')"),u.SPHttpClient.configurations.v1,{headers:{Accept:"application/json;odata=nometadata","odata-version":""}})];case 1:return n.sent().ok?[2,!0]:[4,this.spHttpClient.post("".concat(this.siteUrl,"/_api/web/lists"),u.SPHttpClient.configurations.v1,{headers:{Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=nometadata","odata-version":""},body:JSON.stringify({__metadata:{type:"SP.List"},AllowContentTypes:!0,BaseTemplate:100,ContentTypesEnabled:!0,Description:"List to track employee birthdays and work anniversaries",Title:e})})];case 2:return n.sent().ok?[4,this.spHttpClient.post("".concat(this.siteUrl,"/_api/web/lists/getbytitle('").concat(e,"')/fields"),u.SPHttpClient.configurations.v1,{headers:{Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=nometadata","odata-version":""},body:JSON.stringify({__metadata:{type:"SP.FieldDateTime"},FieldTypeKind:4,Title:"HireDate",DisplayFormat:1})})]:(console.error("Failed to create list"),[2,!1]);case 3:return n.sent(),[4,this.spHttpClient.post("".concat(this.siteUrl,"/_api/web/lists/getbytitle('").concat(e,"')/fields"),u.SPHttpClient.configurations.v1,{headers:{Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=nometadata","odata-version":""},body:JSON.stringify({__metadata:{type:"SP.FieldDateTime"},FieldTypeKind:4,Title:"Birthday",DisplayFormat:1})})];case 4:return n.sent(),[4,this.spHttpClient.post("".concat(this.siteUrl,"/_api/web/lists/getbytitle('").concat(e,"')/fields"),u.SPHttpClient.configurations.v1,{headers:{Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=nometadata","odata-version":""},body:JSON.stringify({__metadata:{type:"SP.Field"},FieldTypeKind:2,Title:"Certification"})})];case 5:return n.sent(),[4,this.spHttpClient.post("".concat(this.siteUrl,"/_api/web/lists/getbytitle('").concat(e,"')/fields"),u.SPHttpClient.configurations.v1,{headers:{Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=nometadata","odata-version":""},body:JSON.stringify({__metadata:{type:"SP.FieldDateTime"},FieldTypeKind:4,Title:"CertificationExpiration",DisplayFormat:1})})];case 6:return n.sent(),[2,!0];case 7:return t=n.sent(),console.error("Error ensuring list exists:",t),[2,!1];case 8:return[2]}})})},e.prototype.getEmployees=function(e){return p(this,void 0,void 0,function(){var t,n;return m(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,this.spHttpClient.get("".concat(this.siteUrl,"/_api/web/lists/getbytitle('").concat(e,"')/items?$select=Id,Title,HireDate,Birthday,Certification,CertificationExpiration"),u.SPHttpClient.configurations.v1,{headers:{Accept:"application/json;odata=nometadata","odata-version":""}})];case 1:if(!(t=a.sent()).ok)throw new Error("Failed to fetch employees: ".concat(t.statusText));return[4,t.json()];case 2:return[2,a.sent().value.map(function(e){return{Id:e.Id,Title:e.Title,HireDate:e.HireDate?new Date(e.HireDate):null,Birthday:e.Birthday?new Date(e.Birthday):null,Certification:e.Certification||null,CertificationExpiration:e.CertificationExpiration?new Date(e.CertificationExpiration):null}})];case 3:return n=a.sent(),console.error("Error fetching employees:",n),[2,[]];case 4:return[2]}})})},e.prototype.getAllLists=function(){return p(this,void 0,void 0,function(){var e,t;return m(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.spHttpClient.get("".concat(this.siteUrl,"/_api/web/lists?$filter=Hidden eq false and BaseTemplate eq 100&$select=Title,Id"),u.SPHttpClient.configurations.v1,{headers:{Accept:"application/json;odata=nometadata","odata-version":""}})];case 1:if(!(e=n.sent()).ok)throw new Error("Failed to fetch lists: ".concat(e.statusText));return[4,e.json()];case 2:return[2,n.sent().value.map(function(e){return{title:e.Title,id:e.Id}})];case 3:return t=n.sent(),console.error("Error fetching lists:",t),[2,[]];case 4:return[2]}})})},e.prototype.processEmployeeEvents=function(e,t){var n=this;void 0===t&&(t=c.All);var a=[],i=new Date;i.setHours(0,0,0,0);var r=i.getFullYear();return e.forEach(function(e){if(e.Birthday){var t=n.calculateNextOccurrence(e.Birthday,r);a.push({id:e.Id,name:e.Title,date:t,type:"birthday",originalDate:e.Birthday})}if(e.HireDate){var o=n.calculateNextOccurrence(e.HireDate,r),s=n.calculateYearsOfService(e.HireDate,o);a.push({id:e.Id,name:e.Title,date:o,type:"anniversary",originalDate:e.HireDate,yearsCount:s})}if(e.Certification&&e.CertificationExpiration){var c=new Date(e.CertificationExpiration.toString());if(c.setHours(0,0,0,0),i.getTime()<=c.getTime()){var d=new Date;d.setHours(0,0,0,0),a.push({id:e.Id,name:e.Title,date:d,type:"certification",originalDate:e.CertificationExpiration,certificationName:e.Certification})}}}),this.filterEvents(a,t,i).sort(function(e,t){return e.date.getTime()-t.date.getTime()})},e.prototype.calculateNextOccurrence=function(e,t){var n=new Date,a=e.getMonth(),i=e.getDate(),r=new Date(t,a,i);return r.getTime()<n.getTime()&&(r=new Date(t+1,a,i)),r},e.prototype.calculateYearsOfService=function(e,t){return t.getFullYear()-e.getFullYear()},e.prototype.filterEvents=function(e,t,n){var a=this;switch(t){case c.Today:return e.filter(function(e){return a.isSameDay(e.date,n)});case c.ThisWeek:var i=new Date(n.getTime());return i.setDate(n.getDate()+(7-n.getDay())),e.filter(function(e){return e.date.getTime()>=n.getTime()&&e.date.getTime()<=i.getTime()});case c.ThisMonth:return e.filter(function(e){return e.date.getMonth()===n.getMonth()&&e.date.getFullYear()===n.getFullYear()});case c.NextMonth:var r=new Date(n.getTime());return r.setMonth(n.getMonth()+1),e.filter(function(e){return e.date.getMonth()===r.getMonth()&&e.date.getFullYear()===r.getFullYear()});case c.All:default:return e}},e.prototype.isSameDay=function(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()},e}(),h=d(529),b=(f=function(e,t){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},f(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},v=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};const y=function(t){function n(e){var n=t.call(this,e)||this;return n.carouselInterval=null,n.state={events:[],loading:!0,error:"",currentIndex:0,gridPage:0},n.employeeService=new _(e.spHttpClient,e.siteUrl),n}return b(n,t),n.prototype.componentDidMount=function(){return g(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this._loadEvents()];case 1:return e.sent(),this.props.displayMode===s.Carousel&&this._startCarousel(),[2]}})})},n.prototype.componentWillUnmount=function(){this._stopCarousel()},n.prototype.componentDidUpdate=function(e){return g(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.listName===this.props.listName&&e.filterMode===this.props.filterMode?[3,2]:[4,this._loadEvents()];case 1:t.sent(),t.label=2;case 2:return this.props.displayMode===s.Carousel&&e.displayMode!==s.Carousel?this._startCarousel():this.props.displayMode!==s.Carousel&&e.displayMode===s.Carousel&&this._stopCarousel(),[2]}})})},n.prototype._loadEvents=function(){return g(this,void 0,void 0,function(){var e,t,n;return v(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),this.setState({loading:!0,error:""}),[4,this.employeeService.getEmployees(this.props.listName)];case 1:return e=a.sent(),t=this.employeeService.processEmployeeEvents(e,this.props.filterMode),this.setState({events:t,loading:!1}),[3,3];case 2:return n=a.sent(),console.error("Error loading events:",n),this.setState({error:"Failed to load employee data. Please check your list configuration.",loading:!1}),[3,3];case 3:return[2]}})})},n.prototype._startCarousel=function(){var e=this;this.carouselInterval=window.setInterval(function(){e.setState(function(e){return{currentIndex:(e.currentIndex+1)%Math.max(e.events.length,1)}})},5e3)},n.prototype._stopCarousel=function(){null!==this.carouselInterval&&(window.clearInterval(this.carouselInterval),this.carouselInterval=null)},n.prototype._formatDate=function(e){return"".concat(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]," ").concat(e.getDate())},n.prototype._renderEventCard=function(t){var n="",a="",i="";"birthday"===t.type?(n="🎂",a="Birthday",i=this.props.birthdayColor):"anniversary"===t.type?(n="🎉",a="".concat(t.yearsCount," Year").concat(1!==t.yearsCount?"s":""," Anniversary"),i=this.props.anniversaryColor):"certification"===t.type&&(n="🏆",a="Certification: ".concat(t.certificationName),i="#28a745, #20c997");var r=i.split(",").map(function(e){return e.trim()}),o=r[0],s=r[1],c={background:"linear-gradient(135deg, ".concat(o," 0%, ").concat(s," 100%)")};return e.createElement("div",{key:"".concat(t.type,"-").concat(t.id),className:"eventCard_8e0aff2a",style:c},this.props.showImages&&e.createElement("div",{className:"iconContainer_8e0aff2a"},e.createElement("span",{className:"icon_8e0aff2a"},n)),e.createElement("div",{className:"eventDetails_8e0aff2a"},e.createElement("h3",{className:"employeeName_8e0aff2a"},(0,h.escape)(t.name)),e.createElement("p",{className:"eventType_8e0aff2a"},a),e.createElement("p",{className:"eventDate_8e0aff2a"},"certification"===t.type?"Congratulations!":this._formatDate(t.date))))},n.prototype._renderGridView=function(){var t=this,n=this.props.centerContent,a=this.state,i=a.events,o=a.gridPage;if(n){var s=Math.ceil(i.length/4),c=4*o,d=c+4,l=i.slice(c,d);return e.createElement("div",{className:"gridViewWithArrows_8e0aff2a"},o>0&&e.createElement("button",{className:r,onClick:function(){t.setState(function(e){return{gridPage:e.gridPage>0?e.gridPage-1:e.gridPage}})},"aria-label":"Previous"},"‹"),e.createElement("div",{className:"gridViewCentered_8e0aff2a"},l.map(function(e){return t._renderEventCard(e)})),o<s-1&&e.createElement("button",{className:r,onClick:function(){t.setState(function(e){return{gridPage:e.gridPage<s-1?e.gridPage+1:e.gridPage}})},"aria-label":"Next"},"›"))}return e.createElement("div",{className:"gridView_8e0aff2a"},i.map(function(e){return t._renderEventCard(e)}))},n.prototype._renderListView=function(){var t=this;return e.createElement("div",{className:"listView_8e0aff2a"},this.state.events.map(function(n){var a="",i="";return"birthday"===n.type?(a="🎂",i="Birthday"):"anniversary"===n.type?(a="🎉",i="".concat(n.yearsCount," Year").concat(1!==n.yearsCount?"s":""," Anniversary")):"certification"===n.type&&(a="🏆",i="Certification: ".concat(n.certificationName)),e.createElement("div",{key:"".concat(n.type,"-").concat(n.id),className:"listItem_8e0aff2a"},t.props.showImages&&e.createElement("span",{className:"listIcon_8e0aff2a"},a),e.createElement("div",{className:"listContent_8e0aff2a"},e.createElement("span",{className:"listName_8e0aff2a"},(0,h.escape)(n.name)),e.createElement("span",{className:"listType_8e0aff2a"},i)),e.createElement("span",{className:"listDate_8e0aff2a"},"certification"===n.type?"Congratulations!":t._formatDate(n.date)))}))},n.prototype._renderCarouselView=function(){var t=this;if(0===this.state.events.length)return e.createElement("div",{className:o},"No upcoming celebrations");var n=this.state.events[this.state.currentIndex];return e.createElement("div",{className:"carouselView_8e0aff2a"},this._renderEventCard(n),e.createElement("div",{className:"carouselIndicators_8e0aff2a"},this.state.events.map(function(n,a){return e.createElement("span",{key:a,className:"".concat("indicator_8e0aff2a"," ").concat(a===t.state.currentIndex?"active_8e0aff2a":""),onClick:function(){return t.setState({currentIndex:a})}})})))},n.prototype.render=function(){var t=this.props,n=t.displayMode,a=t.hasTeamsContext,i=t.showTitle,r=t.centerContent,c=this.state,d=c.loading,l=c.error,u=c.events;return e.createElement("section",{className:"".concat("companyAnniversariesBirthdays_8e0aff2a"," ").concat(a?"teams_8e0aff2a":""," ").concat(r?"centered_8e0aff2a":"")},i&&e.createElement("div",{className:"header_8e0aff2a"},e.createElement("h2",{className:"title_8e0aff2a"},"Company Celebrations")),d&&e.createElement("div",{className:"loading_8e0aff2a"},"Loading celebrations..."),l&&e.createElement("div",{className:"error_8e0aff2a"},l),!d&&!l&&0===u.length&&e.createElement("div",{className:o},"No upcoming celebrations for the selected period."),!d&&!l&&u.length>0&&e.createElement(e.Fragment,null,n===s.Grid&&this._renderGridView(),n===s.List&&this._renderListView(),n===s.Carousel&&this._renderCarouselView()))},n}(e.Component);var S=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),D=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},I=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};const x=function(i){function r(){var e=null!==i&&i.apply(this,arguments)||this;return e._isDarkTheme=!1,e._listDropdownOptions=[],e}return S(r,i),r.prototype.render=function(){var n=e.createElement(y,{listName:this.properties.listName||"Employee Celebrations",displayMode:this.properties.displayMode||s.Grid,filterMode:this.properties.filterMode||c.ThisMonth,showImages:!1!==this.properties.showImages,showTitle:!1!==this.properties.showTitle,centerContent:!0===this.properties.centerContent,birthdayColor:this.properties.birthdayColor||"#f093fb,#f5576c",anniversaryColor:this.properties.anniversaryColor||"#4facfe,#00f2fe",isDarkTheme:this._isDarkTheme,spHttpClient:this.context.spHttpClient,siteUrl:this.context.pageContext.web.absoluteUrl,hasTeamsContext:!!this.context.sdks.microsoftTeams});t.render(n,this.domElement)},r.prototype.onInit=function(){return D(this,void 0,void 0,function(){return I(this,function(e){switch(e.label){case 0:return[4,i.prototype.onInit.call(this)];case 1:return e.sent(),[4,this._loadLists()];case 2:return e.sent(),[2,Promise.resolve()]}})})},r.prototype._loadLists=function(){return D(this,void 0,void 0,function(){var e;return I(this,function(t){switch(t.label){case 0:return[4,new _(this.context.spHttpClient,this.context.pageContext.web.absoluteUrl).getAllLists()];case 1:return e=t.sent(),this._listDropdownOptions=e.map(function(e){return{key:e.title,text:e.title}}),[2]}})})},r.prototype.onThemeChanged=function(e){if(e){this._isDarkTheme=!!e.isInverted;var t=e.semanticColors;t&&(this.domElement.style.setProperty("--bodyText",t.bodyText||null),this.domElement.style.setProperty("--link",t.link||null),this.domElement.style.setProperty("--linkHovered",t.linkHovered||null))}},r.prototype.onDispose=function(){t.unmountComponentAtNode(this.domElement)},Object.defineProperty(r.prototype,"dataVersion",{get:function(){return n.Version.parse("1.0")},enumerable:!1,configurable:!0}),r.prototype.getPropertyPaneConfiguration=function(){return{pages:[{header:{description:"Configure the Company Anniversaries and Birthdays web part"},groups:[{groupName:"Data Source",groupFields:[(0,a.PropertyPaneDropdown)("listName",{label:"Select Employee List",options:this._listDropdownOptions,selectedKey:this.properties.listName||"Employee Celebrations"})]},{groupName:"Display Settings",groupFields:[(0,a.PropertyPaneDropdown)("displayMode",{label:"Display Mode",options:[{key:s.Grid,text:"Grid View"},{key:s.List,text:"List View"},{key:s.Carousel,text:"Carousel View"}],selectedKey:this.properties.displayMode||s.Grid}),(0,a.PropertyPaneDropdown)("filterMode",{label:"Show Events",options:[{key:c.Today,text:"Today Only"},{key:c.ThisWeek,text:"This Week"},{key:c.ThisMonth,text:"This Month"},{key:c.NextMonth,text:"Next Month"},{key:c.All,text:"All Upcoming"}],selectedKey:this.properties.filterMode||c.ThisMonth}),(0,a.PropertyPaneToggle)("showImages",{label:"Show Images",checked:!1!==this.properties.showImages,onText:"On",offText:"Off"}),(0,a.PropertyPaneToggle)("showTitle",{label:"Show Title",checked:!1!==this.properties.showTitle,onText:"On",offText:"Off"}),(0,a.PropertyPaneToggle)("centerContent",{label:"Center Content",checked:!0===this.properties.centerContent,onText:"On",offText:"Off"})]},{groupName:"Colors",groupFields:[(0,a.PropertyPaneTextField)("birthdayColor",{label:"Birthday Colors (gradient: color1,color2)",description:"Enter two colors separated by comma for gradient",placeholder:"#f093fb,#f5576c"}),(0,a.PropertyPaneTextField)("anniversaryColor",{label:"Anniversary Colors (gradient: color1,color2)",description:"Enter two colors separated by comma for gradient",placeholder:"#4facfe,#00f2fe"})]}]}]}},r}(i.BaseClientSideWebPart)})(),l})());